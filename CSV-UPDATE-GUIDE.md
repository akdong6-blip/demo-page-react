# CSV 데이터 업데이트 가이드 (Git 기반)

이 문서는 BECON cloud 프론트엔드 프로젝트에서 Git을 통해 CSV 데이터를 업데이트하는 방법을 설명합니다.

## ⚠️ 중요: 현재 설정 상태

현재 프로젝트는 **Vercel Blob Storage**에서 CSV 데이터를 불러오고 있습니다.
Git 기반 워크플로우로 전환하려면 먼저 아래의 "초기 설정" 단계를 완료해야 합니다.

---

## 📋 목차
1. [초기 설정 (최초 1회만)](#초기-설정-최초-1회만)
2. [CSV 파일 준비하기](#csv-파일-준비하기)
3. [Git을 통해 업데이트하기](#git을-통해-업데이트하기)
4. [확인하기](#확인하기)
5. [문제 해결](#문제-해결)

---

## 초기 설정 (최초 1회만)

Git 기반 워크플로우로 전환하기 위한 초기 설정입니다.

### 1단계: 현재 CSV 파일 다운로드

1. 브라우저에서 다음 URL을 엽니다:
   \`\`\`
   https://hebbkx1anhila5yf.public.blob.vercel-storage.com/sites%20_%EC%A7%80%EC%97%AD%EB%AA%85%ED%86%B5%EC%9D%BC-mZ6vACXTfhwAAv5mKF4p6fdFR3kvOF.csv
   \`\`\`

2. 파일이 다운로드되면 이름을 `sites.csv`로 변경합니다

3. 다운로드한 파일을 프로젝트의 `public/data/` 폴더에 복사합니다

### 2단계: 코드 수정 요청

개발팀에 다음 사항을 요청합니다:

"CSV 파일을 Git 기반으로 전환해주세요. `lib/csv-parser.ts` 파일의 `CSV_URL`을 `/data/sites.csv`로 변경해주세요."

### 3단계: 확인

변경 후 웹사이트에서 현장 수가 935개로 정상 표시되는지 확인합니다.

---

## 1. CSV 파일 준비하기

### 1-1. CSV 파일 형식 확인

CSV 파일은 다음 19개의 열(컬럼)을 포함해야 합니다:

| 열 이름 | 데이터 타입 | 예시 |
|---------|------------|------|
| 현장명 | 텍스트 | H시범_신성쇼핑2 |
| ID_SITE | 숫자 | 10022298 |
| 분석일수(일) | 숫자 | 27 |
| 절감사용량(Kwh) | 숫자 | 12196 |
| 비절감절감량(Kwh) | 숫자 | 13234 |
| 절감량(Kwh) | 숫자 | 1038 |
| 절감금액(원) | 숫자 | 1550558 |
| 비절감금액(원) | 숫자 | 1684988 |
| 절감비용(원) | 텍스트 | 134430 |
| 월 | 숫자 | 3 |
| 연 | 숫자 | 2024 |
| 현장 구분 | 텍스트 | 대형 |
| 업태 | 텍스트 | 상업시설 |
| 실내기 대수 | 숫자 | 134 |
| 구분 | 텍스트 | 체험 |
| 절감률 | 텍스트 | 7.80% |
| 지역 | 텍스트 | 인천 |
| 한전 요금 | 텍스트 | 일반 산업용(갑) |
| 탄소배출량 | 텍스트 | 반영 예정 |

### 1-2. CSV 파일을 UTF-8로 저장하기

**중요:** CSV 파일은 반드시 **UTF-8 인코딩**으로 저장해야 합니다. 그렇지 않으면 한글이 깨질 수 있습니다.

#### Excel에서 UTF-8 CSV로 저장하는 방법:

1. Excel에서 데이터 파일을 엽니다
2. **파일** → **다른 이름으로 저장** 클릭
3. **파일 형식**에서 **CSV UTF-8(쉼표로 분리)(*.csv)** 선택
4. 파일 이름을 `sites.csv`로 입력하고 **저장** 클릭

> **주의사항:**
> - "CSV(쉼표로 분리)(*.csv)"가 아닌 **"CSV UTF-8"**을 선택해야 합니다!
> - 파일 이름은 반드시 `sites.csv`여야 합니다

### 1-3. 지역명 통일하기

필터 기능이 제대로 작동하려면 지역명이 통일되어야 합니다.

Excel에서 **찾기 및 바꾸기**(Ctrl+H) 기능을 사용하여 다음과 같이 변경하세요:

| 변경 전 | 변경 후 |
|---------|---------|
| 서울특별시, 서울시 | 서울 |
| 인천광역시, 인천시 | 인천 |
| 경기도 | 경기 |
| 부산광역시, 부산시 | 부산 |
| 대구광역시, 대구시 | 대구 |
| 광주광역시, 광주시 | 광주 |
| 대전광역시, 대전시 | 대전 |
| 울산광역시, 울산시 | 울산 |
| 세종특별자치시 | 세종 |
| 강원특별자치도, 강원도 | 강원 |
| 충청북도 | 충북 |
| 충청남도 | 충남 |
| 전북특별자치도, 전라북도 | 전북 |
| 전라남도 | 전남 |
| 경상북도 | 경북 |
| 경상남도 | 경남 |
| 제주특별자치도, 제주도 | 제주 |

---

## 2. Git을 통해 업데이트하기

### 2-1. 프로젝트 폴더 열기

1. 컴퓨터에서 프로젝트 폴더를 찾아 엽니다
2. 프로젝트 폴더 안에 `public` 폴더가 있는지 확인합니다
3. `public` 폴더 안에 `data` 폴더가 있는지 확인합니다

폴더 구조:
\`\`\`
프로젝트 폴더/
├── public/
│   ├── data/
│   │   └── sites.csv  ← 이 파일을 교체합니다
│   ├── images/
│   └── fonts/
├── components/
├── app/
└── ...
\`\`\`

### 2-2. CSV 파일 교체하기

1. `public/data/` 폴더를 엽니다
2. 기존 `sites.csv` 파일을 삭제합니다
3. 준비한 새로운 `sites.csv` 파일을 이 폴더에 복사합니다

> **확인:** 파일 이름이 정확히 `sites.csv`인지 확인하세요 (대소문자 구분)

### 2-3. Git으로 변경사항 커밋하기

#### 방법 1: GitHub Desktop 사용 (초보자 추천)

1. GitHub Desktop을 엽니다
2. 왼쪽에서 변경된 파일 목록을 확인합니다
   - `public/data/sites.csv` 파일이 표시되어야 합니다
3. 왼쪽 하단의 **Summary** 입력란에 커밋 메시지를 입력합니다
   - 예: "CSV 데이터 업데이트 - 2024년 3월"
4. **Commit to main** 버튼을 클릭합니다
5. 상단의 **Push origin** 버튼을 클릭하여 GitHub에 업로드합니다

#### 방법 2: 터미널/명령 프롬프트 사용

1. 프로젝트 폴더에서 터미널을 엽니다
2. 다음 명령어를 순서대로 입력합니다:

\`\`\`bash
# 1. 변경사항 확인
git status

# 2. CSV 파일 추가
git add public/data/sites.csv

# 3. 커밋 (메시지는 원하는 대로 변경 가능)
git commit -m "CSV 데이터 업데이트 - 2024년 3월"

# 4. GitHub에 푸시
git push
\`\`\`

### 2-4. 자동 배포 확인

Git에 푸시하면 Vercel이 자동으로 배포를 시작합니다.

1. [Vercel Dashboard](https://vercel.com/dashboard)에 로그인합니다
2. 프로젝트를 선택합니다
3. **Deployments** 탭에서 배포 상태를 확인합니다
4. 배포가 완료되면 (보통 1-2분 소요) 웹사이트에 새로운 데이터가 반영됩니다

---

## 3. 확인하기

### 3-1. 로컬에서 먼저 테스트하기 (선택사항)

배포하기 전에 로컬에서 먼저 테스트할 수 있습니다:

1. 터미널에서 다음 명령어를 실행합니다:
\`\`\`bash
npm run dev
\`\`\`

2. 브라우저에서 `http://localhost:3000`을 엽니다

3. 다음 항목들을 확인합니다:
   - **대시보드**: 통계 숫자가 올바른지 확인
   - **현황**: 지역별 현황이 올바른지 확인
   - **필터**: 월별, 업태별, 규모별 필터가 작동하는지 확인

### 3-2. 배포된 사이트에서 확인하기

1. 배포가 완료되면 실제 웹사이트를 엽니다
2. 브라우저 캐시를 지우고 새로고침합니다 (Ctrl+Shift+R 또는 Cmd+Shift+R)
3. 다음을 확인합니다:
   - 총 현장 수가 올바른지
   - 지역별 현황이 올바른지
   - 필터가 정상 작동하는지
   - 한글이 깨지지 않았는지

---

## 4. 문제 해결

### 문제 1: 한글이 깨져서 표시됩니다

**원인:** CSV 파일이 UTF-8로 저장되지 않았습니다.

**해결 방법:**
1. Excel에서 CSV 파일을 다시 엽니다
2. **파일** → **다른 이름으로 저장** → **CSV UTF-8** 형식으로 저장합니다
3. 위의 Git 업데이트 과정을 다시 진행합니다

### 문제 2: 데이터가 표시되지 않습니다

**원인:** 파일 이름이나 위치가 잘못되었습니다.

**해결 방법:**
1. 파일 이름이 정확히 `sites.csv`인지 확인합니다 (대소문자 구분)
2. 파일이 `public/data/` 폴더에 있는지 확인합니다
3. 브라우저 콘솔(F12)을 열어서 에러 메시지를 확인합니다

### 문제 3: Git push가 실패합니다

**원인:** Git 권한이 없거나 충돌이 발생했습니다.

**해결 방법:**
1. GitHub 계정에 로그인되어 있는지 확인합니다
2. 저장소에 대한 쓰기 권한이 있는지 확인합니다
3. 다음 명령어로 최신 코드를 먼저 받아옵니다:
\`\`\`bash
git pull
\`\`\`
4. 충돌이 발생하면 개발팀에 문의합니다

### 문제 4: 필터가 작동하지 않습니다

**원인:** CSV 파일의 열 이름이나 데이터 형식이 올바르지 않습니다.

**해결 방법:**
1. CSV 파일의 첫 번째 행(헤더)이 위의 표와 정확히 일치하는지 확인합니다
2. 특히 다음 열들을 주의깊게 확인합니다:
   - **월**: 숫자만 입력 (1, 2, 3, ...)
   - **현장 구분**: "대형", "중형", "중소형", "소형" 중 하나
   - **업태**: 정확한 업태명 입력
   - **지역**: 통일된 지역명 사용
3. 빈 셀이나 잘못된 데이터가 없는지 확인합니다

### 문제 5: 배포는 되었는데 데이터가 업데이트되지 않습니다

**원인:** 브라우저 캐시 때문입니다.

**해결 방법:**
1. 브라우저 캐시를 강제로 지웁니다:
   - Windows: Ctrl + Shift + R
   - Mac: Cmd + Shift + R
2. 또는 시크릿 모드(Incognito)로 사이트를 엽니다
3. 그래도 안 되면 5-10분 정도 기다린 후 다시 확인합니다

---

## 📊 데이터 검증 체크리스트

CSV 파일을 업데이트하기 전에 다음 사항들을 확인하세요:

- [ ] 파일 이름이 `sites.csv`입니다
- [ ] UTF-8 인코딩으로 저장했습니다
- [ ] 19개의 열이 모두 포함되어 있습니다
- [ ] 첫 번째 행이 헤더(열 이름)입니다
- [ ] 지역명이 통일되어 있습니다
- [ ] 월 데이터가 숫자(1-12)입니다
- [ ] 현장 구분이 "대형", "중형", "중소형", "소형" 중 하나입니다
- [ ] 빈 행이나 잘못된 데이터가 없습니다

---

## 🔄 정기 업데이트 권장 사항

- **월별 업데이트**: 매월 초에 전월 데이터를 추가합니다
- **분기별 검토**: 3개월마다 데이터 품질을 검토합니다
- **연간 정리**: 1년에 한 번 오래된 데이터를 정리합니다

---

## 📞 도움이 필요하신가요?

위의 방법으로 해결되지 않는 문제가 있다면:

1. 에러 메시지를 스크린샷으로 캡처합니다
2. 어떤 단계에서 문제가 발생했는지 메모합니다
3. CSV 파일의 처음 5줄을 복사합니다
4. 개발팀에 위 정보와 함께 문의합니다

**연락처:** [개발팀 이메일 또는 연락처]
