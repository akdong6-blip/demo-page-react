# CSV 데이터 업데이트 가이드

이 문서는 BECON cloud 프론트엔드 프로젝트에서 CSV 데이터를 업데이트하는 방법을 설명합니다.

## 📋 목차
1. [CSV 파일 준비하기](#csv-파일-준비하기)
2. [CSV 파일 업로드하기](#csv-파일-업로드하기)
3. [코드에서 CSV URL 변경하기](#코드에서-csv-url-변경하기)
4. [확인하기](#확인하기)
5. [문제 해결](#문제-해결)

---

## 1. CSV 파일 준비하기

### 1-1. CSV 파일 형식 확인
CSV 파일은 다음 열(컬럼)을 포함해야 합니다:

| 열 이름 | 데이터 타입 | 예시 |
|---------|------------|------|
| 현장명 | 텍스트 | H시범_신성쇼핑2 |
| ID_SITE | 숫자 | 10022298 |
| 분석일수(일) | 숫자 | 27 |
| 절감사용량(Kwh) | 숫자 | 12196 |
| 비절감절감량(Kwh) | 숫자 | 13234 |
| 절감량(Kwh) | 숫자 | 1038 |
| 절감금액(원) | 숫자 | 1550558 |
| 비절감금액(원) | 숫자 | 1684988 |
| 절감비용(원) | 텍스트 | 134430 |
| 월 | 숫자 | 3 |
| 연 | 숫자 | 2024 |
| 현장 구분 | 텍스트 | 대형 |
| 업태 | 텍스트 | 상업시설 |
| 실내기 대수 | 숫자 | 134 |
| 구분 | 텍스트 | 체험 |
| 절감률 | 텍스트 | 7.80% |
| 지역 | 텍스트 | 인천 |
| 한전 요금 | 텍스트 | 일반 산업용(갑) |
| 탄소배출량 | 텍스트 | 반영 예정 |

### 1-2. CSV 파일을 UTF-8로 저장하기

**중요:** CSV 파일은 반드시 **UTF-8 인코딩**으로 저장해야 합니다. 그렇지 않으면 한글이 깨질 수 있습니다.

#### Excel에서 UTF-8 CSV로 저장하는 방법:

1. Excel에서 데이터 파일을 엽니다
2. **파일** → **다른 이름으로 저장** 클릭
3. **파일 형식**에서 **CSV UTF-8(쉼표로 분리)(*.csv)** 선택
4. 파일 이름을 입력하고 **저장** 클릭

![Excel UTF-8 저장](https://i.imgur.com/example.png)

> **주의:** "CSV(쉼표로 분리)(*.csv)"가 아닌 **"CSV UTF-8"**을 선택해야 합니다!

---

## 2. CSV 파일 업로드하기

CSV 파일을 준비했다면, Vercel Blob Storage에 업로드해야 합니다.

### 2-1. Vercel Blob Storage에 업로드

1. [Vercel Dashboard](https://vercel.com/dashboard)에 로그인합니다
2. 프로젝트를 선택합니다
3. 상단 메뉴에서 **Storage** 탭을 클릭합니다
4. **Blob** 섹션을 선택합니다
5. **Upload** 버튼을 클릭하고 준비한 CSV 파일을 선택합니다
6. 업로드가 완료되면 파일의 **URL**을 복사합니다

예시 URL:
\`\`\`
https://hebbkx1anhila5yf.public.blob.vercel-storage.com/sites-ABC123.csv
\`\`\`

---

## 3. 코드에서 CSV URL 변경하기

### 3-1. csv-parser.ts 파일 열기

프로젝트 폴더에서 다음 파일을 찾아 엽니다:
\`\`\`
lib/csv-parser.ts
\`\`\`

### 3-2. CSV_URL 변경하기

파일 상단에 있는 `CSV_URL` 변수를 찾아서 새로운 URL로 변경합니다:

**변경 전:**
\`\`\`typescript
const CSV_URL =
  "https://hebbkx1anhila5yf.public.blob.vercel-storage.com/sites-OLD_URL.csv"
\`\`\`

**변경 후:**
\`\`\`typescript
const CSV_URL =
  "https://hebbkx1anhila5yf.public.blob.vercel-storage.com/sites-NEW_URL.csv"
\`\`\`

### 3-3. 파일 저장하기

변경 사항을 저장합니다 (Ctrl+S 또는 Cmd+S).

---

## 4. 확인하기

### 4-1. 로컬에서 테스트하기

터미널에서 다음 명령어를 실행하여 개발 서버를 시작합니다:

\`\`\`bash
npm run dev
\`\`\`

브라우저에서 `http://localhost:3000`을 열고 다음을 확인합니다:

1. **대시보드 페이지**: 통계 숫자가 올바르게 표시되는지 확인
2. **현황 페이지**: 지역별 현황이 올바르게 표시되는지 확인
3. **필터 기능**: 월별, 업태별, 규모별 필터가 작동하는지 확인

### 4-2. 배포하기

모든 것이 정상적으로 작동하면 변경 사항을 배포합니다:

\`\`\`bash
git add .
git commit -m "CSV 데이터 업데이트"
git push
\`\`\`

Vercel이 자동으로 배포를 시작합니다.

---

## 5. 문제 해결

### 문제 1: 한글이 깨져서 표시됩니다

**원인:** CSV 파일이 UTF-8로 저장되지 않았습니다.

**해결 방법:**
1. CSV 파일을 다시 열어서 **CSV UTF-8** 형식으로 저장합니다
2. 새로운 파일을 Vercel Blob Storage에 업로드합니다
3. `lib/csv-parser.ts`에서 URL을 업데이트합니다

### 문제 2: 데이터가 표시되지 않습니다

**원인:** CSV URL이 잘못되었거나 파일이 업로드되지 않았습니다.

**해결 방법:**
1. Vercel Blob Storage에서 파일이 제대로 업로드되었는지 확인합니다
2. URL을 다시 복사하여 `lib/csv-parser.ts`에 붙여넣습니다
3. 브라우저 콘솔(F12)을 열어서 에러 메시지를 확인합니다

### 문제 3: 필터가 작동하지 않습니다

**원인:** CSV 파일의 열 이름이나 데이터 형식이 올바르지 않습니다.

**해결 방법:**
1. CSV 파일의 첫 번째 행(헤더)이 위의 표와 정확히 일치하는지 확인합니다
2. 데이터 타입이 올바른지 확인합니다 (숫자는 숫자로, 텍스트는 텍스트로)
3. 특수 문자나 공백이 없는지 확인합니다

### 문제 4: 지역명이 통일되지 않았습니다

**원인:** 지역 열에 "인천광역시", "인천시", "인천" 등 다양한 형식이 섞여 있습니다.

**해결 방법:**
1. Excel에서 **찾기 및 바꾸기** 기능을 사용합니다
2. "인천광역시" → "인천"으로 일괄 변경합니다
3. 다른 지역도 동일하게 통일합니다:
   - "서울특별시" → "서울"
   - "경기도" → "경기"
   - "부산광역시" → "부산"
   - 등등...

---

## 📞 도움이 필요하신가요?

문제가 계속 발생하면 다음을 확인해주세요:

1. CSV 파일이 UTF-8로 저장되었는지
2. 모든 필수 열이 포함되어 있는지
3. 데이터에 빈 값이나 잘못된 형식이 없는지

그래도 해결되지 않으면 개발팀에 문의해주세요.
